<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AStar.Dev.OneDrive.Client.Accounts"
             xmlns:converters="using:AStar.Dev.OneDrive.Client.Converters"
             x:Class="AStar.Dev.OneDrive.Client.Accounts.AccountManagementViewColorful"
             x:DataType="vm:AccountManagementViewModel">

    <Design.DataContext>
        <vm:AccountManagementViewModel />
    </Design.DataContext>

    <UserControl.Resources>
        <converters:BoolToStatusTextConverter x:Key="BoolToStatusTextConverter"/>
    </UserControl.Resources>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Fun Header -->
        <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
            <TextBlock Text="ðŸ‘¥ Your Accounts" FontSize="26" FontWeight="Black">
                <TextBlock.Foreground>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#667eea" Offset="0"/>
                        <GradientStop Color="#764ba2" Offset="1"/>
                    </LinearGradientBrush>
                </TextBlock.Foreground>
            </TextBlock>
            <TextBlock Text="Manage all your cloud connections in one place!"
                       FontSize="14" Foreground="#666666"/>
        </StackPanel>

        <!-- Accounts Grid -->
        <ScrollViewer Grid.Row="1">
            <ListBox ItemsSource="{Binding Accounts}"
                     SelectedItem="{Binding SelectedAccount}"
                     Background="Transparent"
                     BorderThickness="0">
                <ListBox.Styles>
                    <Style Selector="ListBoxItem">
                        <Setter Property="Padding" Value="0"/>
                        <Setter Property="Margin" Value="0,0,0,16"/>
                    </Style>
                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent"/>
                    </Style>
                </ListBox.Styles>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border CornerRadius="16" Padding="20" BoxShadow="0 4 12 0 #20000000">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Color="#4FACFE" Offset="0"/>
                                    <GradientStop Color="#00F2FE" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Grid ColumnDefinitions="Auto,*">
                                <!-- Avatar with Rainbow Border -->
                                <Border Grid.Column="0" Width="60" Height="60" CornerRadius="30">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                            <GradientStop Color="#FF6B6B" Offset="0"/>
                                            <GradientStop Color="#FFE66D" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <TextBlock Text="ðŸ‘¤" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>

                                <!-- Info -->
                                <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding DisplayName}" FontWeight="Bold" FontSize="16" Foreground="White"/>
                                    <TextBlock Text="{Binding AccountId}" FontSize="13" Foreground="#DDFFFFFF" Margin="0,4,0,0"/>
                                    <Border Background="#40FFFFFF" CornerRadius="12" Padding="8,4" Margin="0,8,0,0" HorizontalAlignment="Left">
                                        <TextBlock Text="{Binding IsAuthenticated, Converter={StaticResource BoolToStatusTextConverter}}"
                                                   FontSize="11" FontWeight="Bold" Foreground="White"/>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>

                <ListBox.Styles>
                    <Style Selector="ListBox:empty">
                        <Setter Property="Template">
                            <ControlTemplate>
                                <Border Background="#F0F4FF" BorderBrush="#667eea" BorderThickness="2"
                                        CornerRadius="16" Padding="40" MinHeight="250">
                                    <StackPanel Spacing="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <TextBlock Text="ðŸŽˆ" FontSize="64" HorizontalAlignment="Center"/>
                                        <TextBlock Text="No accounts yet!" FontSize="20" FontWeight="Bold">
                                            <TextBlock.Foreground>
                                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                                                    <GradientStop Color="#667eea" Offset="0"/>
                                                    <GradientStop Color="#764ba2" Offset="1"/>
                                                </LinearGradientBrush>
                                            </TextBlock.Foreground>
                                        </TextBlock>
                                        <TextBlock Text="Let's add your first OneDrive account!"
                                                   FontSize="13" Foreground="#666666" TextAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </ControlTemplate>
                        </Setter>
                    </Style>
                </ListBox.Styles>
            </ListBox>
        </ScrollViewer>

        <!-- Fun Buttons -->
        <Grid Grid.Row="2" ColumnDefinitions="*,*" RowDefinitions="Auto,Auto"
              Margin="0,24,0,0">
            <Button Grid.Row="0" Grid.Column="0" Content="âž• Add Account" Command="{Binding AddAccountCommand}"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Height="50"
                    Background="#FF6B6B" Foreground="White" CornerRadius="16" FontWeight="Bold"
                    IsEnabled="{Binding !IsLoading}" Margin="0,0,6,6"/>
            <Button Grid.Row="0" Grid.Column="1" Content="ðŸ—‘ï¸ Remove" Command="{Binding RemoveAccountCommand}"
                    Height="50" Background="#FF6B6B" Foreground="White" CornerRadius="16" FontWeight="Bold"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                    IsEnabled="{Binding !IsLoading}" Margin="6,0,0,6"/>
            <Button Grid.Row="1" Grid.Column="0" Content="ðŸ”“ Sign In" Command="{Binding LoginCommand}"
                    Height="50" Background="#4ECDC4" Foreground="White" CornerRadius="16" FontWeight="Bold"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                    IsEnabled="{Binding !IsLoading}" Margin="0,6,6,0"/>
            <Button Grid.Row="1" Grid.Column="1" Content="ðŸ”’ Sign Out" Command="{Binding LogoutCommand}"
                    Height="50" Background="#95E1D3" Foreground="White" CornerRadius="16" FontWeight="Bold"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                    IsEnabled="{Binding !IsLoading}" Margin="6,6,0,0"/>
        </Grid>

        <!-- Bouncy Toast -->
        <Border Grid.Row="0" Grid.RowSpan="3"
                IsVisible="{Binding ToastVisible}"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Margin="0,20,0,0"
                ZIndex="100">
            <Border CornerRadius="20" Padding="20,16" BoxShadow="0 8 24 0 #60000000">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Color="#FF6B6B" Offset="0"/>
                        <GradientStop Color="#FFE66D" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <TextBlock Text="{Binding ToastMessage}" Foreground="White" FontSize="14" FontWeight="Bold"/>
            </Border>
        </Border>

        <!-- Loading Indicator -->
        <Border Grid.Row="0" Grid.RowSpan="3"
                Background="#E0FFFFFF"
                IsVisible="{Binding IsLoading}"
                CornerRadius="20">
            <StackPanel HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Spacing="20">
                <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center"/>
                <TextBlock Text="Loading magic..." Foreground="#667eea" FontSize="16" FontWeight="Bold"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
