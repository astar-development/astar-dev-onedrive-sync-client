<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AStar.Dev.OneDrive.Client.Accounts"
             x:Class="AStar.Dev.OneDrive.Client.Accounts.AccountManagementViewProfessional"
             x:DataType="vm:AccountManagementViewModel">

    <Design.DataContext>
        <vm:AccountManagementViewModel />
    </Design.DataContext>

    <UserControl.Resources>
        <SolidColorBrush x:Key="PrimaryBrush">#0078D4</SolidColorBrush>
        <SolidColorBrush x:Key="SecondaryBrush">#F8F9FA</SolidColorBrush>
    </UserControl.Resources>

    <UserControl.Styles>
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style Selector="Button.primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="#106EBE"/>
        </Style>

        <Style Selector="Button.secondary">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#0078D4"/>
            <Setter Property="BorderBrush" Value="#0078D4"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
    </UserControl.Styles>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="4" Margin="0,0,0,24">
            <TextBlock Text="Accounts" FontSize="22" FontWeight="SemiBold" Foreground="#1A1A1A"/>
            <TextBlock Text="Manage your OneDrive connections" FontSize="13" Foreground="#666666"/>
        </StackPanel>

        <!-- Accounts List -->
        <ScrollViewer Grid.Row="1">
            <ListBox ItemsSource="{Binding Accounts}"
                     SelectedItem="{Binding SelectedAccount}"
                     Background="Transparent"
                     BorderThickness="0">
                <ListBox.Styles>
                    <Style Selector="ListBoxItem">
                        <Setter Property="Padding" Value="0"/>
                        <Setter Property="Margin" Value="0,0,0,12"/>
                    </Style>
                    <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent"/>
                    </Style>
                </ListBox.Styles>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Background="#F8F9FA"
                                BorderBrush="#E0E0E0"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="16">
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <!-- Avatar -->
                                <Border Grid.Column="0" Width="48" Height="48"
                                        Background="#0078D4" CornerRadius="24"
                                        VerticalAlignment="Center">
                                    <TextBlock Text="{Binding DisplayName, Converter={StaticResource InitialsConverter}}"
                                               Foreground="White" FontSize="18" FontWeight="SemiBold"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>

                                <!-- Account Info -->
                                <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" FontSize="14" Foreground="#1A1A1A"/>
                                    <TextBlock Text="{Binding AccountId}" FontSize="12" Foreground="#666666" Margin="0,2,0,0"/>
                                    <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,6,0,0">
                                        <Ellipse Width="8" Height="8" Fill="{Binding IsAuthenticated, Converter={StaticResource BoolToStatusColorConverter}}"/>
                                        <TextBlock Text="{Binding IsAuthenticated, Converter={StaticResource BoolToStatusTextConverter}}"
                                                   FontSize="11" Foreground="#666666"/>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Selection Indicator -->
                                <Border Grid.Column="2" Width="4" Height="48" Background="#0078D4" CornerRadius="2"
                                        IsVisible="{Binding $parent[ListBoxItem].IsSelected}"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>

                <ListBox.Styles>
                    <Style Selector="ListBox:empty">
                        <Setter Property="Template">
                            <ControlTemplate>
                                <Border Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="1"
                                        CornerRadius="6" Padding="32" MinHeight="200">
                                    <StackPanel Spacing="12" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <PathIcon Data="M12,12A5,5 0 0,1 17,7A5,5 0 0,1 22,12A5,5 0 0,1 17,17A5,5 0 0,1 12,12M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                                                  Width="48" Height="48" Foreground="#CCCCCC"/>
                                        <TextBlock Text="No accounts added" FontSize="15" FontWeight="SemiBold" Foreground="#666666"/>
                                        <TextBlock Text="Click 'Add Account' to connect your OneDrive"
                                                   FontSize="12" Foreground="#999999" TextWrapping="Wrap" TextAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </ControlTemplate>
                        </Setter>
                    </Style>
                </ListBox.Styles>
            </ListBox>
        </ScrollViewer>

        <!-- Actions -->
        <Grid Grid.Row="2" ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" Margin="0,24,0,0">
            <Button Grid.Row="0" Grid.Column="0" Content="Add Account" Command="{Binding AddAccountCommand}"
                    Classes="primary" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="0,0,4,4"/>
            <Button Grid.Row="0" Grid.Column="1" Content="Remove" Command="{Binding RemoveAccountCommand}"
                    Classes="secondary" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="4,0,0,4"/>
            <Button Grid.Row="1" Grid.Column="0" Content="Sign In" Command="{Binding LoginCommand}"
                    Classes="secondary" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="0,4,4,0"/>
            <Button Grid.Row="1" Grid.Column="1" Content="Sign Out" Command="{Binding LogoutCommand}"
                    Classes="secondary" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="4,4,0,0"/>
        </Grid>

        <!-- Toast Notification -->
        <Border Grid.Row="0" Grid.RowSpan="3"
                IsVisible="{Binding ToastVisible}"
                Background="Transparent"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Margin="0,0,0,0">
            <Border Background="#323232" CornerRadius="4" Padding="16,12"
                    BoxShadow="0 4 12 0 #40000000">
                <TextBlock Text="{Binding ToastMessage}" Foreground="White" FontSize="13"/>
            </Border>
        </Border>

        <!-- Loading Overlay -->
        <Border Grid.Row="0" Grid.RowSpan="3"
                Background="#F0FFFFFF"
                IsVisible="{Binding IsLoading}"
                CornerRadius="8">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4" Foreground="#0078D4"/>
                <TextBlock Text="Loading accounts..." Foreground="#666666" FontSize="13"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
