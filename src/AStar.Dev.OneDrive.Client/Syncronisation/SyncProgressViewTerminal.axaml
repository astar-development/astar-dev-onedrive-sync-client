<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AStar.Dev.OneDrive.Client.Syncronisation"
             x:Class="AStar.Dev.OneDrive.Client.Syncronisation.SyncProgressViewTerminal"
             x:DataType="vm:SyncProgressViewModel"
             FontFamily="Consolas, monospace">

    <Design.DataContext>
        <vm:SyncProgressViewModel />
    </Design.DataContext>

    <UserControl.Styles>
        <!-- Neon button style -->
        <Style Selector="Button.neon">
            <Setter Property="Background" Value="#001100"/>
            <Setter Property="Foreground" Value="#00FF41"/>
            <Setter Property="BorderBrush" Value="#00FF41"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontFamily" Value="Consolas, monospace"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <Style Selector="Button.neon:pointerover">
            <Setter Property="Background" Value="#003300"/>
        </Style>

        <Style Selector="Button.neon-red">
            <Setter Property="Background" Value="#110000"/>
            <Setter Property="Foreground" Value="#FF0000"/>
            <Setter Property="BorderBrush" Value="#FF0000"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontFamily" Value="Consolas, monospace"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <Style Selector="Button.neon-red:pointerover">
            <Setter Property="Background" Value="#330000"/>
        </Style>
    </UserControl.Styles>

    <!-- Terminal Overlay -->
    <Border Background="#F0000000">
        <Border Background="#111111"
                BorderBrush="#00FF41"
                BorderThickness="2"
                MaxWidth="700"
                MaxHeight="500"
                Padding="24"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">

            <Grid RowDefinitions="Auto,Auto,*,Auto">
                <!-- Terminal Header -->
                <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,16">
                    <Border Background="#001100" BorderBrush="#00FF41" BorderThickness="0,0,0,2" Padding="0,0,0,8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="█▓▒░" FontSize="14" Foreground="#00FF41" FontWeight="Bold"/>
                            <TextBlock Text="SYNC_PROGRESS_MONITOR" FontSize="14" Foreground="#00FF41" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <TextBlock Text="{Binding StatusMessage, StringFormat='>> {0}'}"
                               FontSize="12"
                               Foreground="#00AA33"
                               FontWeight="SemiBold" />
                </StackPanel>

                <!-- Progress Display -->
                <StackPanel Grid.Row="1" Spacing="16" Margin="0,0,0,16">
                    <!-- File Progress -->
                    <StackPanel Spacing="6">
                        <TextBlock Text="{Binding FilesProgressText, StringFormat='[{0}]'}"
                                   HorizontalAlignment="Center"
                                   FontSize="13"
                                   Foreground="#00FF41"
                                   FontWeight="Bold" />
                        <ProgressBar Value="{Binding ProgressPercentage}"
                                     Minimum="0"
                                     Maximum="100"
                                     Height="8"
                                     IsIndeterminate="{Binding IsProgressIndeterminate}"
                                     Foreground="#00FF41"
                                     Background="#001100"
                                     BorderBrush="#00FF41"
                                     BorderThickness="1" />
                        <TextBlock Text="{Binding ProgressPercentage, StringFormat='{}{0:F1}% COMPLETE'}"
                                   HorizontalAlignment="Center"
                                   FontSize="10"
                                   Foreground="#00AA33" />
                    </StackPanel>

                    <!-- Transfer Details -->
                    <Border Background="#001100"
                            BorderBrush="#00FF41"
                            BorderThickness="1"
                            Padding="12"
                            IsVisible="{Binding CurrentProgress, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Spacing="4">
                            <TextBlock Text="[TRANSFER_METRICS]"
                                       Foreground="#00FF41"
                                       FontSize="10"
                                       FontWeight="Bold"/>
                            <TextBlock Text="{Binding TransferDetailsText}"
                                       FontSize="10"
                                       Foreground="#00AA33"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Conflicts Warning -->
                <Border Grid.Row="2"
                        Background="#110000"
                        BorderBrush="#FF0000"
                        BorderThickness="2"
                        Padding="16"
                        Margin="0,0,0,16"
                        IsVisible="{Binding HasConflicts}">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="[!]" Foreground="#FF0000" FontSize="16" FontWeight="Bold"/>
                            <TextBlock Text="CONFLICT_ALERT" Foreground="#FF0000" FontSize="12" FontWeight="Bold"/>
                        </StackPanel>
                        <TextBlock Text="{Binding ConflictsText}"
                                   FontSize="11"
                                   Foreground="#FF6666"
                                   TextWrapping="Wrap"/>
                        <TextBlock Text=">> Manual resolution required after sync completion"
                                   FontSize="10"
                                   Foreground="#AA0000"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Action Buttons -->
                <Grid Grid.Row="3" ColumnDefinitions="*">
                    <Button Grid.Column="0"
                            Content="[CLOSE]"
                            Command="{Binding CloseCommand}"
                            Classes="neon"
                            HorizontalAlignment="Stretch"
                            Height="36"/>
                </Grid>

                <!-- Status Footer -->
                <Border Grid.Row="3"
                        Background="#000000"
                        BorderBrush="#00FF41"
                        BorderThickness="0,2,0,0"
                        Padding="10"
                        Margin="0,16,-24,-24">
                    <TextBlock Text="{Binding StatusMessage, StringFormat='[STATUS: {0}]'}"
                               HorizontalAlignment="Center"
                               FontSize="10"
                               Foreground="#00AA33"
                               TextWrapping="Wrap" />
                </Border>
            </Grid>
        </Border>
    </Border>
</UserControl>
