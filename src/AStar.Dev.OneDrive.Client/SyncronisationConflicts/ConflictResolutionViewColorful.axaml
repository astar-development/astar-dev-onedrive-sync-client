<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AStar.Dev.OneDrive.Client.SyncronisationConflicts"
             xmlns:enums="clr-namespace:AStar.Dev.OneDrive.Client.Core.Models.Enums;assembly=AStar.Dev.OneDrive.Client.Core"
             xmlns:converters="using:AStar.Dev.OneDrive.Client.Converters"
             x:Class="AStar.Dev.OneDrive.Client.SyncronisationConflicts.ConflictResolutionViewColorful"
             x:DataType="vm:ConflictResolutionViewModel">

    <Design.DataContext>
        <vm:ConflictResolutionViewModel />
    </Design.DataContext>

    <UserControl.Resources>
        <converters:EnumToBooleanConverter x:Key="EnumToBooleanConverter"/>
    </UserControl.Resources>

    <Border CornerRadius="20" Padding="32">
        <Border.Background>
            <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                <GradientStop Color="#FFFFFF" Offset="0"/>
                <GradientStop Color="#F0F4FF" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>

        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Header -->
            <StackPanel Grid.Row="0" Spacing="12" Margin="0,0,0,24">
                <TextBlock Text="âš ï¸ Resolve Conflicts" FontSize="28" FontWeight="Black">
                    <TextBlock.Foreground>
                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                            <GradientStop Color="#FF6B6B" Offset="0"/>
                            <GradientStop Color="#FFE66D" Offset="1"/>
                        </LinearGradientBrush>
                    </TextBlock.Foreground>
                </TextBlock>
                <TextBlock Text="Oops! Some files need your attention!"
                           FontSize="15" Foreground="#666666" TextWrapping="Wrap"/>
                <Border Background="#FFF9E6" BorderBrush="#FFE66D" BorderThickness="2"
                        CornerRadius="12" Padding="12,8">
                    <TextBlock Text="{Binding StatusMessage}" FontSize="14" FontWeight="SemiBold"
                               Foreground="#FF6B6B"/>
                </Border>
            </StackPanel>

            <!-- Conflicts List -->
            <ScrollViewer Grid.Row="1" IsVisible="{Binding HasConflicts}">
                <ItemsControl ItemsSource="{Binding Conflicts}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="vm:ConflictItemViewModel">
                            <Border CornerRadius="16" Padding="24" Margin="0,0,0,20"
                                    BoxShadow="0 4 16 0 #30000000">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                        <GradientStop Color="#FFFFFF" Offset="0"/>
                                        <GradientStop Color="#FFF5F5" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>

                                <Grid RowDefinitions="Auto,Auto,Auto,Auto">
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="ðŸ“„" FontSize="20"/>
                                        <TextBlock Text="{Binding FilePath}" FontWeight="Bold"
                                                   FontSize="16" Foreground="#333333" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <Grid Grid.Row="1" ColumnDefinitions="*,16,*" Margin="0,0,0,16">
                                        <Border Grid.Column="0" CornerRadius="12" Padding="16"
                                                BoxShadow="0 2 8 0 #20000000">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                                    <GradientStop Color="#4FACFE" Offset="0"/>
                                                    <GradientStop Color="#00F2FE" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <StackPanel Spacing="6">
                                                <TextBlock Text="ðŸ’» Local Version" FontSize="13"
                                                           Foreground="White" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding LocalDetailsDisplay}" FontSize="12"
                                                           Foreground="#DDFFFFFF" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>

                                        <TextBlock Grid.Column="1" Text="âš”ï¸" FontSize="20"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>

                                        <Border Grid.Column="2" CornerRadius="12" Padding="16"
                                                BoxShadow="0 2 8 0 #20000000">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                                    <GradientStop Color="#FF6B6B" Offset="0"/>
                                                    <GradientStop Color="#FFE66D" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <StackPanel Spacing="6">
                                                <TextBlock Text="â˜ï¸ Remote Version" FontSize="13"
                                                           Foreground="White" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding RemoteDetailsDisplay}" FontSize="12"
                                                           Foreground="#DDFFFFFF" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>

                                    <TextBlock Grid.Row="2" Text="Choose your action:" FontSize="14"
                                               FontWeight="Bold" Foreground="#333333" Margin="0,0,0,8"/>

                                    <StackPanel Grid.Row="3" Spacing="12">
                                        <RadioButton Content="ðŸ’» Keep Local (upload my version)"
                                                     GroupName="{Binding Id}"
                                                     FontSize="14" FontWeight="SemiBold"
                                                     IsChecked="{Binding SelectedStrategy, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:ConflictResolutionStrategy.KeepLocal}}" />
                                        <RadioButton Content="â˜ï¸ Keep Remote (download cloud version)"
                                                     GroupName="{Binding Id}"
                                                     FontSize="14" FontWeight="SemiBold"
                                                     IsChecked="{Binding SelectedStrategy, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:ConflictResolutionStrategy.KeepRemote}}" />
                                        <RadioButton Content="ðŸ‘¥ Keep Both (save both versions)"
                                                     GroupName="{Binding Id}"
                                                     FontSize="14" FontWeight="SemiBold"
                                                     IsChecked="{Binding SelectedStrategy, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:ConflictResolutionStrategy.KeepBoth}}" />
                                        <RadioButton Content="â­ï¸ Skip (I'll decide later)"
                                                     GroupName="{Binding Id}"
                                                     FontSize="14" FontWeight="SemiBold"
                                                     IsChecked="{Binding SelectedStrategy, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:ConflictResolutionStrategy.None}}" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- No Conflicts Message -->
            <Border Grid.Row="1" Background="#E0FFFFFF" CornerRadius="16" Padding="40"
                    IsVisible="{Binding !HasConflicts}">
                <StackPanel Spacing="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="ðŸŽ‰" FontSize="64" HorizontalAlignment="Center"/>
                    <TextBlock Text="All clear!" FontSize="24" FontWeight="Bold"
                               Foreground="#4ECDC4" HorizontalAlignment="Center"/>
                    <TextBlock Text="No conflicts to display" FontSize="16"
                               Foreground="#666666" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Action Buttons -->
            <StackPanel Grid.Row="2" Orientation="Horizontal"
                        HorizontalAlignment="Right" Spacing="16" Margin="0,24,0,0">
                <Button Content="âœ… Resolve All" Command="{Binding ResolveAllCommand}"
                        IsEnabled="{Binding !IsResolving}" MinWidth="140" Height="50"
                        CornerRadius="25" FontWeight="Bold" FontSize="15"
                        Foreground="White" BorderThickness="0">
                    <Button.Background>
                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                            <GradientStop Color="#4ECDC4" Offset="0"/>
                            <GradientStop Color="#95E1D3" Offset="1"/>
                        </LinearGradientBrush>
                    </Button.Background>
                </Button>
                <Button Content="âŒ Cancel" Command="{Binding CancelCommand}"
                        IsEnabled="{Binding !IsResolving}" MinWidth="120" Height="50"
                        Background="#FF6B6B" Foreground="White" CornerRadius="25"
                        FontWeight="Bold" FontSize="15" BorderThickness="0"/>
            </StackPanel>

            <!-- Loading Overlay -->
            <Border Grid.Row="0" Grid.RowSpan="3"
                    Background="#F0FFFFFF"
                    IsVisible="{Binding IsLoading}"
                    CornerRadius="20">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="20">
                    <TextBlock Text="â³" FontSize="48"/>
                    <TextBlock Text="Loading conflicts..." Foreground="#667eea"
                               FontSize="16" FontWeight="Bold"/>
                </StackPanel>
            </Border>

            <!-- Resolving Overlay -->
            <Border Grid.Row="0" Grid.RowSpan="3"
                    Background="#F0FFFFFF"
                    IsVisible="{Binding IsResolving}"
                    CornerRadius="20">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="20">
                    <TextBlock Text="ðŸ”§" FontSize="48"/>
                    <TextBlock Text="{Binding StatusMessage}" Foreground="#667eea"
                               FontSize="16" FontWeight="Bold" TextAlignment="Center" MaxWidth="300"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</UserControl>
