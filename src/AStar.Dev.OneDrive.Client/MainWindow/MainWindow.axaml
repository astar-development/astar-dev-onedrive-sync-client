<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:accounts="using:AStar.Dev.OneDrive.Client.Accounts"
        xmlns:syncronisation="using:AStar.Dev.OneDrive.Client.Syncronisation"
        xmlns:syncronisationConflicts="using:AStar.Dev.OneDrive.Client.SyncronisationConflicts"
        xmlns:vm="using:AStar.Dev.OneDrive.Client.MainWindow"
        Icon="avares://AStar.Dev.OneDrive.Client/Assets/astar.png"
        x:Class="AStar.Dev.OneDrive.Client.MainWindow.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="AStar Dev - OneDrive Multi-Account Sync"
        Width="1200"
        Height="700"
        MinWidth="800"
        MinHeight="500">

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Window.KeyBindings>
        <KeyBinding Gesture="F2" Command="{Binding OpenUpdateAccountDetailsCommand}" />
        <KeyBinding Gesture="Alt+F4" Command="{Binding CloseApplicationCommand}" />
    </Window.KeyBindings>

    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_Update Account Details"
                          Command="{Binding OpenUpdateAccountDetailsCommand}"
                          InputGesture="F2" />
                <MenuItem Header="_View Sync History"
                          Command="{Binding OpenViewSyncHistoryCommand}" />
                <MenuItem Header="_View Debug Logs"
                          Command="{Binding OpenDebugLogViewerCommand}" />
                <Separator />
                <MenuItem Header="_Close Application"
                          Command="{Binding CloseApplicationCommand}"
                          InputGesture="Alt+F4" />
            </MenuItem>
        </Menu>

        <!-- Main Content -->
        <Grid ColumnDefinitions="350,*">
            <!-- Left Panel: Account Management -->
            <Border Grid.Column="0"
                    BorderBrush="{DynamicResource SystemControlForegroundBaseLowBrush}"
                    BorderThickness="0,0,1,0">
                <accounts:AccountManagementView DataContext="{Binding AccountManagement}" />
            </Border>

            <!-- Right Panel: Content Area (Sync Tree, Progress, or Conflicts) -->
            <Panel Grid.Column="1">
                <!-- Sync Tree View (base layer) -->
                <syncronisation:SyncTreeView DataContext="{Binding SyncTree}" />

                <!-- Sync Progress View (overlay when syncing) -->
                <syncronisation:SyncProgressView DataContext="{Binding SyncProgress}"
                                                 IsVisible="{Binding #SyncProgressView.DataContext, Converter={x:Static ObjectConverters.IsNotNull}}"
                                                 x:Name="SyncProgressView" />

                <!-- Conflict Resolution View (top overlay when viewing conflicts) -->
                <syncronisationConflicts:ConflictResolutionView DataContext="{Binding ConflictResolution}"
                                                                IsVisible="{Binding #ConflictResolutionView.DataContext, Converter={x:Static ObjectConverters.IsNotNull}}"
                                                                x:Name="ConflictResolutionView" />
            </Panel>
        </Grid>
    </DockPanel>
</Window>